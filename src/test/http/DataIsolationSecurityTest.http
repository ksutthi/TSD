### ===================================================================
### TSD PLATFORM: SECURITY & DATA ISOLATION TEST SUITE
### Target Port: 8081 (To avoid the Zombie Server)
### ===================================================================

### üõë TEST 14: The Unauthenticated Attack
# Expected Result (Security ON):  403 Forbidden
# Expected Result (Security OFF): 200 OK
POST http://localhost:8081/api/v1/portfolio/isolated-view
Content-Type: application/json
X-Participant-ID: 13

{
  "ginId": 10006
}


### ===================================================================
### BROKER (KGI) SECURITY FLOW
### ===================================================================

### üîë TEST 15: Login as KGI (Participant 13) to get JWT
# Expected Result: 200 OK (Returns a JWT token with ROLE_BROKER)
POST http://localhost:8081/api/v1/auth/login/kgi


### ‚úÖ TEST 16: The Broker Access Test (Passing the Shield)
# Expected Result: 200 OK (Returns 75,000 shares of PTT)
# ‚ö†Ô∏è INSTRUCTION: Replace PASTE_YOUR_KGI_TOKEN_HERE with the token from Test 15
POST http://localhost:8081/api/v1/portfolio/isolated-view
Content-Type: application/json
Authorization: Bearer PASTE_YOUR_KGI_TOKEN_HERE
X-Participant-ID: 13

{
  "ginId": 10006
}


### üõë TEST 17: The Hacker Attack (Broker tries to access Admin God-View)
# Expected Result: 403 Forbidden (Because KGI is a BROKER, not an ADMIN)
# ‚ö†Ô∏è INSTRUCTION: Use the exact same KGI token from Test 15
POST http://localhost:8081/api/v1/portfolio/god-view
Content-Type: application/json
Authorization: Bearer PASTE_YOUR_KGI_TOKEN_HERE

{
  "ginId": 10006
}


### ===================================================================
### TSD ADMIN SECURITY FLOW
### ===================================================================

### üëë TEST 18: Login as TSD Admin to get Admin JWT
# Expected Result: 200 OK (Returns a JWT token with ROLE_TSD_ADMIN)
POST http://localhost:8081/api/v1/auth/login/admin


### ‚úÖ TEST 19: The God View (Admin successfully bypassing RBAC)
# Expected Result: 200 OK
# ‚ö†Ô∏è INSTRUCTION: Replace PASTE_YOUR_ADMIN_TOKEN_HERE with the token from Test 18
POST http://localhost:8081/api/v1/portfolio/god-view
Content-Type: application/json
Authorization: Bearer PASTE_YOUR_ADMIN_TOKEN_HERE

{
  "ginId": 10006
}